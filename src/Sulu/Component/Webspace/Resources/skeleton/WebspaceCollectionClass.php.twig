{% macro create_localizations(localization, count) %}
        $localization{{ count }} = new Localization();
        $localization{{ count }}->setLanguage('{{ localization.language }}');
        $localization{{ count }}->setCountry('{{ localization.country }}');
        $localization{{ count }}->setShadow('{{ (localization.shadow) }}');

{% for childLocalization in localization.children %}
    {{ _self.create_localizations(childLocalization, count + 1) }}
{% endfor %}
        $localization{{ count - 1 }}->addChild($localization{{ count }});
{% endmacro %}

<?php
use Sulu\Component\Webspace\WebspaceCollection;
use Sulu\Component\Webspace\Portal;
use Sulu\Component\Webspace\Localization;
use Sulu\Component\Webspace\Theme;
use Sulu\Component\Webspace\Environment;
use Sulu\Component\Webspace\Segment;
use Sulu\Component\Webspace\Url;
use Sulu\Component\Webspace\Webspace;

/**
 * {{ cache_class }}
 *
 * DO NOT EDIT
 * This file is autogenerated by the Sulu Webspace component
 */
class {{ cache_class }} extends {{ base_class }}
{
    public function __construct()
    {
{% for webspace in webspaces %}
        // new webspace
        $webspace = new Webspace();
        $webspace->setKey('{{ webspace.key }}');
        $webspace->setName('{{ webspace.name }}');

{% for localization in webspace.localizations %}
        // add localization to webspace
        $localization0 = new Localization();
        $localization0->setLanguage('{{ localization.language }}');
        $localization0->setCountry('{{ localization.country }}');
        $localization0->setShadow('{{ (localization.shadow) }}');
{% for childLocalization in localization.children %}
{{ _self.create_localizations(childLocalization, 1) }}
{% endfor %}
        $webspace->addLocalization($localization0);

{% endfor %}

{% for segment in webspace.segments %}
        // add segment to webspace
        $segment = new Segment();
        $segment->setName('{{ segment.name }}');
        $segment->setKey('{{ segment.key }}');
        $webspace->addSegment($segment);

{% endfor %}

        // add theme
        $theme = new Theme();
        $theme->setKey('{{ webspace.theme.key }}');
{% for excludedTemplate in webspace.theme.excludedTemplates %}        $theme->addExcludedTemplate('{{ excludedTemplate }}');
{% endfor %}        $webspace->setTheme($theme);

{% for portal in webspace.portals %}

        // new portal
        $portal = new Portal();
        $portal->setName('{{ portal.name }}');
        $portal->setKey('{{ portal.key }}');
        $portal->setResourceLocatorStrategy('{{ portal.resourceLocator.strategy }}');
        $portal->setWebspace($webspace);
{% for localization in portal.localizations %}

        // add localization
        $localization = new Localization();
        $localization->setLanguage('{{ localization.language }}');
        $localization->setCountry('{{ localization.country }}');
        $portal->addLocalization($localization);
{% endfor %}

{% for environment in portal.environments %}

        // add environment
        $environment = new Environment();
        $environment->setType('{{ environment.type }}');
{% for url in environment.urls %}

        // add environment url
        $url = new Url();
        $url->setUrl('{{ url.url }}');
        $url->setLanguage('{{ url.language }}');
        $url->setCountry('{{ url.country }}');
        $url->setSegment('{{ url.segment }}');
        $url->setRedirect('{{ url.redirect }}');
        $environment->addUrl($url);
{% endfor %}

        $portal->addEnvironment($environment);
{% endfor %}

        $webspace->addPortal($portal);

{% endfor %}
        $this->add($webspace);
{% endfor %}
    }
}
