define(["services/sulucontact/account-manager","services/sulucontact/account-router","services/sulucontact/account-delete-dialog"],function(a,b,c){"use strict";var d={datagridInstanceName:"accounts",listViewStorageKey:"accountListView"},e=function(){this.sandbox.on("sulu.toolbar.delete",function(){this.sandbox.emit("husky.datagrid."+d.datagridInstanceName+".items.get-selected",f.bind(this))},this),this.sandbox.on("sulu.contacts.account.deleted",function(a){this.sandbox.emit("husky.datagrid."+d.datagridInstanceName+".record.remove",a)},this),this.sandbox.on("sulu.toolbar.add",function(){b.toAdd()},this),this.sandbox.on("husky.datagrid."+d.datagridInstanceName+".number.selections",function(a){var b=a>0?"enable":"disable";this.sandbox.emit("sulu.header.toolbar.item."+b,"deleteSelected",!1)},this),this.sandbox.on("sulu.toolbar.change.table",function(){this.sandbox.emit("husky.datagrid."+d.datagridInstanceName+".view.change","table"),this.sandbox.sulu.saveUserSetting(d.listViewStorageKey,"table")}.bind(this)),this.sandbox.on("sulu.toolbar.change.cards",function(){this.sandbox.emit("husky.datagrid."+d.datagridInstanceName+".view.change","decorators/cards"),this.sandbox.sulu.saveUserSetting(d.listViewStorageKey,"decorators/cards")}.bind(this))},f=function(b){c.showDialog(b,function(c){a["delete"](b,c)}.bind(this))},g=function(a){b.toEdit(a)};return{layout:{content:{width:"max"}},header:{noBack:!0,title:"contact.accounts.title",toolbar:{buttons:{add:{},deleteSelected:{}}}},templates:["/admin/contact/template/account/list"],initialize:function(){this.render(),e.call(this)},getListToolbarConfig:function(){return{el:this.$find("#list-toolbar-container"),instanceName:"accounts",template:this.sandbox.sulu.buttons.get({accountDecoratorDropdown:{},settings:{options:{dropdownItems:[{type:"columnOptions"}]}}})}},getDatagridConfig:function(){return{el:this.sandbox.dom.find("#companies-list",this.$el),url:"/admin/api/accounts?flat=true",searchInstanceName:"accounts",searchFields:["name"],resultKey:"accounts",instanceName:d.datagridInstanceName,actionCallback:g.bind(this),view:this.sandbox.sulu.getUserSetting(d.listViewStorageKey)||"decorators/cards",viewOptions:{"decorators/cards":{imageFormat:"100x100-inset",fields:{picture:"logo",title:["name"],firstInfoRow:["city","countryCode"],secondInfoRow:["mainEmail"]},separators:{title:" ",infoRow:", "},icons:{picture:"fa-home",firstInfoRow:"fa-map-marker",secondInfoRow:"fa-envelope"}}}}},render:function(){this.sandbox.dom.html(this.$el,this.renderTemplate("/admin/contact/template/account/list")),this.sandbox.sulu.initListToolbarAndList.call(this,"accounts","/admin/api/accounts/fields",this.getListToolbarConfig(),this.getDatagridConfig(),"accounts","#companies-list-info")}}});