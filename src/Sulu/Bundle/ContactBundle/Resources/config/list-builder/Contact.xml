<class xmlns="http://schemas.sulu.io/class/general"
       xmlns:orm="http://schemas.sulu.io/class/doctrine"
       xmlns:filter="http://schemas.sulu.io/class/filter">

    <orm:joins name="address">
        <orm:join>
            <orm:entity-name>SuluContactBundle:ContactAddress</orm:entity-name>
            <orm:field-name>%sulu.model.contact.class%.contactAddresses</orm:field-name>
            <orm:method>LEFT</orm:method>
            <orm:condition>SuluContactBundle:ContactAddress.main = TRUE</orm:condition>
        </orm:join>
        <orm:join>
            <orm:entity-name>SuluContactBundle:Address</orm:entity-name>
            <orm:field-name>SuluContactBundle:ContactAddress.address</orm:field-name>
        </orm:join>
    </orm:joins>

    <properties>
        <property name="avatar" translation="public.avatar" display="always" type="thumbnails" sortable="false">
            <orm:field-name>id</orm:field-name>
            <orm:entity-name>SuluMediaBundle:Media</orm:entity-name>

            <orm:joins>
                <orm:join>
                    <orm:entity-name>SuluMediaBundle:Media</orm:entity-name>
                    <orm:field-name>%sulu.model.contact.class%.avatar</orm:field-name>
                </orm:join>
            </orm:joins>
        </property>

        <concatenation-property name="fullName" translation="public.name" sortable="false"
                                orm:glue=" " filter:input-type="string">
            <orm:field property-ref="firstName"/>
            <orm:field property-ref="lastName"/>
        </concatenation-property>

        <property name="firstName" translation="contact.contacts.firstName" display="always" filter:input-type="string">
            <orm:field-name>firstName</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="lastName" translation="contact.contacts.lastName" display="always" filter:input-type="string">
            <orm:field-name>lastName</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="mainEmail" translation="public.email" display="always" filter:input-type="string">
            <orm:field-name>mainEmail</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="account" translation="contact.contacts.company" display="always"
                  filter:input-type="auto-complete">
            <orm:field-name>name</orm:field-name>
            <orm:entity-name>%sulu_contact.account.entity%</orm:entity-name>

            <orm:joins>
                <orm:join>
                    <orm:entity-name>SuluContactBundle:AccountContact</orm:entity-name>
                    <orm:field-name>%sulu.model.contact.class%.accountContacts</orm:field-name>
                    <orm:method>LEFT</orm:method>
                    <orm:condition>SuluContactBundle:AccountContact.main = true</orm:condition>
                </orm:join>
                <orm:join>
                    <orm:entity-name>%sulu_contact.account.entity%</orm:entity-name>
                    <orm:field-name>SuluContactBundle:AccountContact.account</orm:field-name>
                </orm:join>
            </orm:joins>

            <filter:parameters>
                <filter:parameter key="remoteUrl"><![CDATA[/admin/api/accounts?searchFields=name,number&flat=true&fields=id,number,name,corporation&limit=25]]></filter:parameter>
                <filter:parameter key="resultKey">accounts</filter:parameter>
                <filter:parameter key="valueKey">name</filter:parameter>
            </filter:parameters>
        </property>

        <property name="city" translation="contact.address.city" display="always" filter:input-type="string">
            <orm:field-name>city</orm:field-name>
            <orm:entity-name>SuluContactBundle:Address</orm:entity-name>

            <orm:joins ref="address"/>
        </property>

        <property name="zip" translation="contact.address.zip" filter:input-type="string">
            <orm:field-name>zip</orm:field-name>
            <orm:entity-name>SuluContactBundle:Address</orm:entity-name>

            <orm:joins ref="address"/>
        </property>

        <property name="state" translation="contact.address.state" filter:input-type="string">
            <orm:field-name>state</orm:field-name>
            <orm:entity-name>SuluContactBundle:Address</orm:entity-name>

            <orm:joins ref="address"/>
        </property>

        <property name="countryCode" translation="contact.address.countryCode" display="always"
                  filter:input-type="string">
            <orm:field-name>code</orm:field-name>
            <orm:entity-name>SuluContactBundle:Country</orm:entity-name>

            <orm:joins ref="address">
                <orm:join>
                    <orm:entity-name>SuluContactBundle:Country</orm:entity-name>
                    <orm:field-name>SuluContactBundle:Address.country</orm:field-name>
                </orm:join>
            </orm:joins>
        </property>

        <property name="mainPhone" translation="public.phone" display="always" filter:input-type="string">
            <orm:field-name>mainPhone</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="id" translation="public.id" type="integer" filter:input-type="integer">
            <orm:field-name>id</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="mainFax" translation="public.fax" filter:input-type="string">
            <orm:field-name>mainFax</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="mainUrl" translation="public.url" filter:input-type="string">
            <orm:field-name>mainUrl</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="created" translation="public.created" type="datetime" filter:input-type="datetime">
            <orm:field-name>created</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="changed" translation="public.changed" type="datetime" filter:input-type="datetime">
            <orm:field-name>changed</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="birthday" translation="contact.contacts.birthday" type="date"
                  filter:input-type="date">
            <orm:field-name>birthday</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="title" translation="public.title">
            <orm:field-name>title</orm:field-name>
            <orm:entity-name>SuluContactBundle:ContactTitle</orm:entity-name>

            <orm:joins>
                <orm:join>
                    <orm:entity-name>SuluContactBundle:ContactTitle</orm:entity-name>
                    <orm:field-name>%sulu.model.contact.class%.title</orm:field-name>
                </orm:join>
            </orm:joins>
        </property>

        <identity-property name="titleId" translation="public.title" display="never"
                           filter:input-type="auto-complete">
            <orm:field-name>title</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>

            <filter:parameters>
                <filter:parameter key="prefetchUrl"><![CDATA[http://sulu.lo/admin/api/contact/titles]]></filter:parameter>
                <filter:parameter key="resultKey">contactTitles</filter:parameter>
                <filter:parameter key="valueKey">title</filter:parameter>
            </filter:parameters>
        </identity-property>

        <property name="salutation" translation="contact.contacts.salutation" filter:input-type="string">
            <orm:field-name>salutation</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="formOfAddress" translation="contact.contacts.formOfAddress" filter:input-type="string">
            <orm:field-name>formOfAddress</orm:field-name>
            <orm:entity-name>%sulu.model.contact.class%</orm:entity-name>
        </property>

        <property name="position" translation="contact.contacts.position" sortable="false" filter:input-type="string">
            <orm:field-name>position</orm:field-name>
            <orm:entity-name>SuluContactBundle:Position</orm:entity-name>

            <orm:joins>
                <orm:join>
                    <orm:entity-name>SuluContactBundle:AccountContact</orm:entity-name>
                    <orm:field-name>%sulu.model.contact.class%.accountContacts</orm:field-name>
                </orm:join>
                <orm:join>
                    <orm:entity-name>SuluContactBundle:Position</orm:entity-name>
                    <orm:field-name>SuluContactBundle:AccountContact.position</orm:field-name>
                </orm:join>
            </orm:joins>
        </property>

        <group-concat-property name="tagIds" translation="public.tags" display="never"
                               orm:glue="," filter:input-type="tags">
            <orm:field-name>id</orm:field-name>
            <orm:entity-name>SuluTagBundle:Tag</orm:entity-name>

            <orm:joins>
                <orm:join>
                    <orm:entity-name>SuluTagBundle:Tag</orm:entity-name>
                    <orm:field-name>%sulu.model.contact.class%.tags</orm:field-name>
                </orm:join>
            </orm:joins>
        </group-concat-property>

        <group-concat-property name="tags" orm:glue=",">
            <orm:field-name>name</orm:field-name>
            <orm:entity-name>SuluTagBundle:Tag</orm:entity-name>

            <orm:joins>
                <orm:join>
                    <orm:entity-name>SuluTagBundle:Tag</orm:entity-name>
                    <orm:field-name>%sulu.model.contact.class%.tags</orm:field-name>
                </orm:join>
            </orm:joins>
        </group-concat-property>
    </properties>
</class>
