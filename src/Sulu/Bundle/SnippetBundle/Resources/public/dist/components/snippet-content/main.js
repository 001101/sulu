define([],function(){"use strict";var a={instanceName:null,urlGet:null,idsParameter:"ids",preselected:[],idKey:"id",titleKey:"title",resultKey:"snippets",urlAll:null,language:null,snippetType:null,webspace:null,translations:{noSnippetsSelected:"snippet-content.nosnippets-selected",addSnippets:"snippet-content.add"}},b={ids:[],config:{}},c="sulu.snippet-content.",d=function(){return e.call(this,"data-changed")},e=function(a){return c+(this.options.instanceName?this.options.instanceName+".":"")+a},f={skeleton:function(a){return['<div class="white-box form-element" id="',a.ids.container,'">','   <div class="header">','       <span class="fa-plus-circle icon left action" id="',a.ids.addButton,'"></span>','       <span class="fa-cog icon right border " id="',a.ids.configButton,'" style="display: none;"></span>',"   </div>",'   <div class="content" id="',a.ids.content,'"></div>',"</div>"].join("")},noContent:function(a){return['<div class="no-content">','   <span class="fa-coffee icon"></span>','   <div class="text">',a,"</div>","</div>"].join("")},data:function(a){return['<div id="',a.ids.snippetList,'"/>'].join("")},contentItem:function(a,b,c){return['<li data-id="',a,'">','   <span class="num">',b,"</span>",'   <span class="value">',c,"</span>",'   <span class="fa-times remove"></span>',"</li>"].join("")}},g=function(a){return"#"+this.options.ids[a]},h=function(){if(this.options.ids={container:"snippet-content-"+this.options.instanceName+"-container",addButton:"snippet-content-"+this.options.instanceName+"-add",configButton:"snippet-content-"+this.options.instanceName+"-config",content:"snippet-content-"+this.options.instanceName+"-content",snippetList:"snippet-content-"+this.options.instanceName+"-column-navigation"},this.sandbox.dom.html(this.$el,f.skeleton(this.options)),this.$container=this.sandbox.dom.find(g.call(this,"container"),this.$el),this.$content=this.sandbox.dom.find(g.call(this,"content"),this.$el),this.$addButton=this.sandbox.dom.find(g.call(this,"addButton"),this.$el),this.$configButton=this.sandbox.dom.find(g.call(this,"configButton"),this.$el),this.sandbox.dom.data(this.$el,"snippet-content")){var a=this.sandbox.util.extend(!0,{},b,this.sandbox.dom.data(this.$el,"snippet-content"));w.call(this,a)}else w.call(this,{ids:this.options.preselected});i.call(this),j.call(this),this.URIGet={str:"",hasChanged:!1},this.URIGetAll={str:"",hasChanged:!1},x.call(this),y.call(this),z.call(this),r.call(this),v.call(this),n.call(this)},i=function(){var a=this.sandbox.translate(this.options.translations.noSnippetsSelected);this.sandbox.dom.html(this.$content,f.noContent(a))},j=function(){this.sandbox.on("husky.overlay.snippet-content."+this.options.instanceName+".add.initialized",m.bind(this)),this.sandbox.dom.on(g.call(this,"content"),"click",k.bind(this),"li .remove"),this.sandbox.on("husky.datagrid.initialized",function(){this.sandbox.emit("husky.overlay.snippet-content."+this.options.instanceName+".add.set-position")}.bind(this))},k=function(a){var b=this.sandbox.dom.parents(a.currentTarget,"li"),c=this.sandbox.dom.data(b,"id");this.sandbox.dom.remove(b),this.data.ids.splice(this.data.ids.indexOf(c),1),l.call(this,c),u.call(this),0===this.items.length?i.call(this):q.call(this),this.sandbox.emit("husky.column-navigation."+this.options.instanceName+".unmark",c),w.call(this,this.data),this.sandbox.emit(d.call(this),this.data,this.$el)},l=function(a){for(var b=-1,c=this.items.length;++b<c;)if(a===this.items[b].id)return this.items.splice(b,1),!0;return!1},m=function(){this.sandbox.start([{name:"datagrid@husky",options:{url:this.URIGetAll.str,preselected:[],pagination:!1,resultKey:this.options.resultKey,sortable:!0,searchInstanceName:"test",searchFields:["title"],columnOptionsInstanceName:"",el:g.call(this,"snippetList"),matchings:[{content:"Title",width:"100%",name:"title",editable:!0,sortable:!0,type:"title",validation:{required:!1}}]}}])},n=function(){this.sandbox.dom.on(this.$el,"click",k.bind(this),".-list .remove")},o=function(){0!==this.items.length?(this.linkList=this.sandbox.dom.createElement('<ul class="items-list"/>'),this.sandbox.util.each(this.items,function(a){p.call(this,this.items[a],this.linkList)}.bind(this)),this.sandbox.dom.html(this.$content,this.linkList),q.call(this)):(i.call(this),u.call(this))},p=function(a,b){this.sandbox.dom.append(b,f.contentItem(a[this.options.idKey],this.sandbox.dom.find("li",b).length+1,a[this.options.titleKey]))},q=function(){this.itemsVisible=this.items.length<this.itemsVisible?this.items.length:this.itemsVisible,(null===this.$footer||void 0===this.$footer)&&(this.$footer=this.sandbox.dom.createElement('<div class="footer"/>')),this.sandbox.dom.append(this.$container,this.$footer)},r=function(){var a=this.sandbox.dom.createElement("<div/>");this.sandbox.dom.append(this.$el,a),this.sandbox.start([{name:"overlay@husky",options:{triggerEl:this.$addButton,cssClass:"snippet-content-overlay",el:a,container:this.$el,instanceName:"snippet-content."+this.options.instanceName+".add",skin:"wide",slides:[{title:this.sandbox.translate(this.options.translations.addSnippets),cssClass:"snippet-content-overlay-add",data:f.data(this.options),okCallback:s.bind(this)}]}}])},s=function(){this.sandbox.emit("husky.datagrid.items.get-selected",function(a){this.data.ids=this.data.ids.concat(a),w.call(this,this.data),x.call(this),v.call(this),this.sandbox.emit(d.call(this),this.data,this.$el)}.bind(this))},t=function(){u.call(this);var a=this.sandbox.dom.createElement('<div class="loader"/>');this.sandbox.dom.html(this.$content,a),this.sandbox.start([{name:"loader@husky",options:{el:a,size:"100px",color:"#e4e4e4"}}])},u=function(){null!==this.$footer&&this.sandbox.dom.remove(this.$footer)},v=function(){if(this.URIGet.hasChanged===!0){var a=function(a){this.items=a,o.call(this)}.bind(this);t.call(this),this.data.ids&&this.data.ids.length>0?this.sandbox.util.load(this.URIGet.str).then(a.bind(this)).fail(function(a){this.sandbox.logger.log(a)}.bind(this)):a.call(this,{_embedded:[]})}},w=function(a){for(var b in a)a.hasOwnProperty(b)&&(this.data[b]=a[b]);this.sandbox.dom.data(this.$el,"snippet-content",this.data)},x=function(){var a=[this.options.urlGet,"/",(this.data.ids||[]).join(","),"?language=",this.options.language].join("");a!==this.URIGet.str?(this.URIGet.str=a,this.URIGet.hasChanged=!0):this.URIGet.hasChanged=!1},y=function(){var a=[this.options.urlAll,"?language=de","&type=",this.options.snippetType].join("");a!==this.URIGetAll.str?(this.URIGetAll.str=a,this.URIGetAll.hasChanged=!0):this.URIGetAll.hasChanged=!1},z=function(){this.sandbox.dom.val(g.call(this,"displayOption"),this.data.displayOption)};return{historyClosed:!0,initialize:function(){this.options=this.sandbox.util.extend({},a,this.options),this.data={},this.linkList=null,this.sandbox.util.each(["snippetType","language","webspace","urlGet","urlAll"],function(a){if(null===this.options[a])throw'you must specify the "'+a+'" option'}.bind(this)),h.call(this)}}});